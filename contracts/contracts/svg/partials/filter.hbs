<filter
  color-interpolation-filters="sRGB"
  id="glowEmboss"
  width="150%"
  height="150%"
>
  <feGaussianBlur
    in="SourceAlpha"
    result="alphablur"
    stdDeviation="8"
  ></feGaussianBlur>

  {{!-- <!-- Background glow  --> --}}
  <feGaussianBlur
    in="SourceGraphic"
    result="graphicblur"
    stdDeviation="8"
  ></feGaussianBlur>
  <feOffset
    dx="0"
    dy="0"
    in="graphicblur"
    result="offsetBlur"
  ></feOffset>

  {{!-- <!-- Emboss/Bevel --> --}}
  {{#each layers}}
    <feSpecularLighting
      in="graphicblur"
      surfaceScale={{surfaceScale}}
      specularConstant={{specConstant}}
      specularExponent={{specularExponent}}
      lightingColor={{lightColor}}
      result="lighting_{{@index}}"
    >
      {{#if (eq lightType "point")}}
        <fePointLight
          x={{pointX}}
          y={{pointY}}
          z={{pointZ}}
        />
      {{/if}}
      {{#if (eq lightType "spotlight")}}
        <feSpotLight
          x={{pointX}}
          y={{pointY}}
          z={{pointZ}}
          limitingConeAngle={{limitingConeAngle}}
          pointsAtX={{pointsAtX}}
          pointsAtY={{pointsAtY}}
          pointsAtZ={{pointsAtZ}}
        />
      {{/if}}
    </feSpecularLighting>
    <feGaussianBlur
      in="lighting_{{@index}}"
      result="blurred_{{@index}}"
      stdDeviation="{{blurX}} {{blurY}}"
    ></feGaussianBlur>
  {{!-- Mask Light to handle shape --}}
    <feComposite
      in2="blurred_{{@index}}"
      in="SourceAlpha"
      operator="{{#if (eq lightType "spotlight")}}in{{/if}}{{#if (eq lightType "point")}}out{{/if}}"
      result="masked_emboss_{{@index}}"
    />

    {{!-- Invert light (black to white) and opacity --}}
    <feColorMatrix
      in="masked_emboss_{{@index}}"
      result="emboss_{{@index}}"
      type="matrix"
      values="-1 0 0 0 1 
              0 -1 0 0 1 
              0 0 -1 0 1
              0 0 0 {{opacity}} 0"
    />
  {{/each}}

  {{!-- May be useful, demo of this here: http://cs.sru.edu/~svg/Chapter05/G05xx46.svg --}}
  {{!-- <feTurbulence baseFrequency=".001" numOctaves="2" result="A">
      <animate attributeName="baseFrequency" dur="100s" values=".005;.002;.001" repeatCount="indefinite"/> 
  </feTurbulence>
  <feComposite
    in2="A"
    in="SourceGraphic"
    operator="arithmetic"
    k1="1"
    k2="1"
    k3="1"
    k4="-1"
    result="C"
  />
  <feTurbulence
    baseFrequency=".005"
    numOctaves="1"
    seed="25"
    result="B"
  >
    <animate attributeName="baseFrequency" dur="200s" values=".02;.01;.001" repeatCount="indefinite"/>
    <animate attributeName="seed" dur="35s" values="30;34" repeatCount="indefinite"/>
  </feTurbulence>
  <feComposite
    in2="B"
    in="SourceGraphic"
    operator="arithmetic"
    k1="0.6"
    k2="1"
    k3="1"
    k4="-1"
    result="D"
  />
  <feComposite
    in2="C"
    in="D"
    operator="arithmetic"
    k1="1"
    k2="1"
    k3="1"
    k4="0"
    result="idk"
  /> --}}

  <feMerge>
    <feMergeNode in="offsetBlur"></feMergeNode>
    <feMergeNode in="SourceGraphic"></feMergeNode>
    {{#each layers}}
      <feMergeNode
        in="emboss_{{@index}}"
        key="node_{{@index}}"
      ></feMergeNode>
    {{/each}}

    {{!-- This mergeNode is used for the turbulence filter above --}}
    {{!-- <feMergeNode in="idk"></feMergeNode> --}}
  </feMerge>
</filter>